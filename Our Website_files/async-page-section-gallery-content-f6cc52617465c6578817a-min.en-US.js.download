(window["wpJsonpExtractCss"]=window["wpJsonpExtractCss"]||[]).push([["async-page-section-gallery-content"],{"./common/temp/node_modules/@sqs/core-components/primitives/SegmentedRadio.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/primitives/SegmentedRadio/index.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/components/LinkEditor.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/components/LinkEditor/index.js");a.d(t,"default",function(){return n["b"]});a.d(t,"InlineLinkEditor",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/modals/AlertModal.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/modals/DismissableModals/AlertModal.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/modals/ReviewingChangesModal.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/modals/DismissableModals/ReviewingChangesModal.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/navigation/Toolbar/index.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Edit.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8 17L19 6l-5-5L3 12v5h5zm-3-4.172l9-9L16.172 6l-9 9H5v-2.172z' fill='%230E0E0E'/%3E%3Cpath d='M3 19h16v2H3v-2z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Search.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.192 15.606a7 7 0 111.414-1.414l3.601 3.601-1.414 1.414-3.6-3.6zM15 10a5 5 0 11-10 0 5 5 0 0110 0z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Upload.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5 14.25V11.5l6-6 6 6v2.75l-5-5V20h-2V9.25l-5 5zM19 2v2H3V2h16z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Video.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 14.3V7.7l5.5 3.3L9 14.3z' fill='%230E0E0E'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M20 4H2v14h18V4zM4 16V6h14v10H4z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./src/main/webapp/universal/src/shared/dispatchers/alt/index.ts"));var s=function e(){(0,r.default)(this,e);this.generateActions("loadStart","loadSuccess","loadFailure")};var l=o.default.createActions(s);t.default=l;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=o;var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/slicedToArray.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var u=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Icon.js"));var p=n(a("./src/main/webapp/universal/src/shared/components/FocalPoint.jsx"));var f=a("./common/temp/node_modules/@sqs/rosetta-icons/build/lib/index.js");var v=a("./src/main/webapp/universal/packages/enums/RecordType.js");var h=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/imageDetailUtils.js");var g=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.less"));var b=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var l=288;var i={LEFT:-1,RIGHT:1};var r=.3;var d=1e3*r;var I="left ".concat(r,"s ease-in-out");function y(e){var t=m.default.useRef();m.default.useEffect(function(){t.current=e},[e]);return t.current}function S(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none";e.forEach(function(e,t){e.style.transition=n;e.style.left="".concat((t-a)*l,"px");"none"===n&&(e.style.transform="none")})}function C(e,t,a,n){var r=e[t];var o=e[a];if(!o||!r)return;var s=parseInt(r.style.left);r.style.transition=I;r.style.transform="translateX(".concat(n*(s*-n-l),"px)");r.style.left="".concat(s+l*n,"px");o.style.transition=I;o.style.left="".concat(l*n,"px");return setTimeout(function(){S(e,t)},d)}function _(t,e){var r=m.default.useRef(null);var o=e.findIndex(function(e){return e.id===t.id});var s=y(o);m.default.useEffect(function(){if(!r.current)return;var e=null;var t=r.current.querySelectorAll("[data-is-image=true]");var a=void 0===s?o:s;S(t,a);if(o!==s)if(void 0!==s&&o+1!==s&&o-1!==s){var n=o>s?i.LEFT:i.RIGHT;e=C(t,o,s,n)}else S(t,o,I);return function(){e&&clearTimeout(e)}},[t,e,o,s,r]);return r}function j(e){var t=e.image,a=void 0===t?{}:t,n=e.onFocalPointChange;var r=a&&(a.jobId?"":a.assetUrl);var o=(0,h.useImageLoader)(r),s=(0,c.default)(o,2),l=s[0],i=s[1];var d=m.default.useRef();var u=a.recordType===v.VIDEO;return m.default.createElement("div",{className:g.default.imageContainer},m.default.createElement("div",{"data-is-image":true,ref:d,className:g.default.image,style:{backgroundImage:"url('".concat(l.src,"')")}},i&&!u&&m.default.createElement(p.default,{key:a.id,visible:i,onChange:n,imageNodeGetter:function e(){return d.current},className:g.default.focalPoint,x:a.mediaFocalPoint.x,y:a.mediaFocalPoint.y}),u&&m.default.createElement(f.Video,{color:b.colors.white,sx:{position:"absolute",top:2,left:2}})))}function o(e){var t=e.selectedImage,a=void 0===t?{}:t,n=e.images,r=e.isFirstImage,o=e.selectPreviousImage,s=e.isLastImage,l=e.selectNextImage,i=e.onFocalPointChange;var d=_(a,n);if(!a)return null;return m.default.createElement("div",{className:g.default.viewer},m.default.createElement("button",{disabled:r,onClick:o},m.default.createElement(u.default,{name:r?"chevronLargeLeftLight":"chevronLargeLeftDark"})),m.default.createElement("div",{ref:d,className:g.default.imageList},n.map(function(e,t){return m.default.createElement(j,{key:e.assetUrl,image:e,onFocalPointChange:i})})),m.default.createElement("button",{disabled:s,onClick:l},m.default.createElement(u.default,{name:s?"chevronLargeRightLight":"chevronLargeRightDark"})))}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.less":function(e,t,a){e.exports={viewer:"Carousel-viewer-1iWSy",imageList:"Carousel-imageList-2xC1x",imageContainer:"Carousel-imageContainer-1ILFO",image:"Carousel-image-2VK8h",focalPoint:"Carousel-focalPoint-3QwEx"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less":function(e,t,a){e.exports={container:"ImageDetail-container-25HgH",emptyState:"ImageDetail-emptyState-2PIIO",multiDeleteButton:"ImageDetail-multiDeleteButton-tbu9-",imageEditorButtonContainer:"ImageDetail-imageEditorButtonContainer-1K1jK",licenseBlock:"ImageDetail-licenseBlock-naGgB",actions:"ImageDetail-actions-2VwYS",stackedImages:"ImageDetail-stackedImages-1c3QP",imageContainer:"ImageDetail-imageContainer-2tRsc",image:"ImageDetail-image-1y5xn",withoutBottomBorderA:"ImageDetail-withoutBottomBorderA-1g3Js",mobileBackButton:"ImageDetail-mobileBackButton-1sxhK",formWrapper:"ImageDetail-formWrapper-2OZKg",shorterFormWrapper:"ImageDetail-shorterFormWrapper-1u-yP"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetailSchemas.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var o=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less"));var s={type:"object",properties:{body:{type:"object",properties:{html:{type:"string"}}},clickthroughUrl:{type:"string"},newWindow:{type:"boolean"}}};var l=[{type:"textarea",$mapping:"#/body/html",properties:{label:(0,r.t)("Description"),placeholder:(0,r.t)("Add a description…"),inline:false}},{type:"context",properties:{label:(0,r.t)("Link")}},{type:"link",$mapping:{url:"#/clickthroughUrl",newWindow:"#/newWindow"},properties:{modalClassName:o.default.withoutBottomBorderA}}];var i={type:"object",properties:{body:{type:"object",properties:{html:{type:"string"}}}}};var d=[{type:"string",$mapping:"#/body/html",properties:{label:(0,r.t)("Description"),placeholder:(0,r.t)("Add a description…"),inline:false}}];var u={imageJsonSchema:s,imageUiSchema:l,videoJsonSchema:i,videoUiSchema:d};t.default=u;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/imageDetailUtils.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.useImageLoader=r;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/slicedToArray.js"));var l=n(a("./common/temp/node_modules/react/index.js"));function r(t){var e=l.default.useState(false),a=(0,s.default)(e,2),n=a[0],r=a[1];var o=l.default.useMemo(function(){r(false);var e=new Image(100,200);e.onload=function(){r(true)};e.src=t;return e},[t]);return[o,n]}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/extends.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var p=n(a("./src/main/webapp/universal/src/shared/components/Form/index.js"));var f=n(a("./src/main/webapp/universal/packages/enums/Flag.js"));var v=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Button.js"));var h=n(a("./common/temp/node_modules/@sqs/core-components/web/components/LinkEditor.js"));var g=a("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var b=a("./common/temp/node_modules/@sqs/jsf-fields/lib/es/main.js");var I=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/BetaFeaturesUtils.js"));var y=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/WebsiteStore/index.js"));var S=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var C=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withLicensedImagePurchaseModal/index.js"));var _=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withImageEditor/index.js"));var j=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.js"));var E=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetailSchemas.js"));var P=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less"));var w=a("./src/main/webapp/universal/packages/enums/RecordType.js");var D=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");function k(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,d.default)(this,t)}}var A=function e(t){return m.default.createElement(h.default,(0,r.default)({},t,{componentProps:I.default.isFeatureEnabled(f.default.NESTED_CATEGORIES)?{CONTENT_PICKER:{websiteId:y.default.getState().get("id"),versions:{collection:{product:"1.1"}}}}:{}}))};var R=function(e){(0,i.default)(r,e);var n=k(r);function r(){var o;(0,s.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];o=n.call.apply(n,[this].concat(t));(0,c.default)((0,l.default)(o),"state",{value:{},isPurchaseLicenseOpen:false,imageLoaded:false});(0,c.default)((0,l.default)(o),"imageRef",m.default.createRef());(0,c.default)((0,l.default)(o),"onChange",function(e){var t=e.value;o.props.onImageDetailChanges(t)});(0,c.default)((0,l.default)(o),"renderHeader",function(){return null});(0,c.default)((0,l.default)(o),"getItemDataById",function(t){var e=o.props,a=e.items,n=e.dirtyMap;var r=n.has(t)?n.get(t):a.find(function(e){return e.id===t});return r});return o}(0,o.default)(r,[{key:"panelRenderer",value:function e(t){return t.children}},{key:"renderLicenseSpecificComponent",value:function e(t){return m.default.createElement("div",{className:P.default.licenseBlock},m.default.createElement("div",{className:P.default.actions},m.default.createElement(v.default,{color:"primary",onClick:this.props.openPurchaseLicenseModal},(0,S.t)("License")),m.default.createElement(v.default,{color:"warning",onClick:this.props.delete},(0,S.t)("Delete"))),m.default.createElement("p",null,(0,S.t)("This is a unlicensed preview image. To license it use the license link above. Watermarks will be removed after purchase.")))}},{key:"renderImageEditorButton",value:function e(t){var a=this;if(t.recordType===w.VIDEO)return m.default.createElement("div",{className:P.default.imageEditorButtonContainer});return m.default.createElement("div",{className:P.default.imageEditorButtonContainer},m.default.createElement(v.default,{color:"primary",onClick:function e(){return a.props.openEditor(t)}},(0,S.t)("Edit Image")))}},{key:"renderSingleImage",value:function e(t){if(!t)return null;var a=this.props,n=a.items,r=a.isFirstImage,o=a.selectPreviousImage,s=a.isLastImage,l=a.selectNextImage,i=a.onFocalPointChange;var d=(0,S.t)("Back");var u=t.recordType===w.IMAGE;return m.default.createElement(m.default.Fragment,null,m.default.createElement("a",{className:P.default.mobileBackButton,onClick:this.props.mobileSwitchToPicker},d),m.default.createElement(j.default,{selectedImage:t,images:n,isFirstImage:r,selectPreviousImage:o,isLastImage:s,selectNextImage:l,onFocalPointChange:i}),t.licensedAssetPreview?this.renderLicenseSpecificComponent(t):this.renderImageEditorButton(t),m.default.createElement(p.default,{components:{string:b.string,textarea:b.textarea,link:A,context:b.context},configurations:{default:{schema:u?E.default.imageJsonSchema:E.default.videoJsonSchema,uiSchema:u?E.default.imageUiSchema:E.default.videoUiSchema,value:t}},onChange:this.onChange,renderHeader:this.renderHeader,renderComponentList:this.panelRenderer,scrollContainerClassName:t.licensedAssetPreview?P.default.shorterFormWrapper:P.default.formWrapper}))}},{key:"renderEmptyState",value:function e(){return m.default.createElement("div",{className:P.default.emptyState},m.default.createElement(g.Text.Body,{color:"gray.400",fontWeight:"500"},(0,S.t)("No Image Selected")))}},{key:"renderLoadingState",value:function e(){return m.default.createElement("div",{className:P.default.emptyState},m.default.createElement(D.ActivityIndicator,null))}},{key:"checkShouldRenderLoading",value:function e(){var t;var a=this.props,n=a.selectedIds,r=a.itemsMap,o=a.items;if(!r.some(function(e){var t=e.contentItemId;return t&&t===n[0]}))return true;if(null===(t=o.find(function(e){var t=e.id;return t===n[0]}))||void 0===t?void 0:t.jobId)return true;return false}},{key:"renderContent",value:function e(){var t=this.props.selectedIds;if(!t||!t.length)return this.renderEmptyState();if(1===t.length){var a=this.checkShouldRenderLoading();if(a)return this.renderLoadingState();var n=this.getItemDataById(t[0]);return this.renderSingleImage(n)}return this.renderMultiDeleteButton()}},{key:"renderMultiDeleteButton",value:function e(){var t=this.props,a=t.selectedIds,n=t.deleteSelectedImages;return m.default.createElement("button",{className:P.default.multiDeleteButton,onClick:function e(){return n()}},(0,S.t)("Delete ({nbImages})",{nbImages:a.length}))}},{key:"render",value:function e(){return m.default.createElement("div",{className:P.default.container},this.renderContent())}}]);return r}(m.default.Component);var x=(0,_.default)((0,C.default)(R));var M=x;t.default=M;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less":function(e,t,a){e.exports={delete:"Image-delete-fZPL2",imageContainer:"Image-imageContainer-1VCI3",thirdImageContainer:"Image-thirdImageContainer-2rGKI",innerContainer:"Image-innerContainer-1tlOF",img:"Image-img-GWhos",isSelected:"Image-isSelected-2Xrgz",hiddenButtonForAccessibility:"Image-hiddenButtonForAccessibility-uXqkc",processing:"Image-processing-4GenB",mobileEditMode:"Image-mobileEditMode-3AIrv",badge:"Image-badge-s0-j9",loading:"Image-loading-2s9_y"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/Image.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var p=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));var f=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");function v(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,o.default)(this,t)}}window.URL=window.URL||window.webkitURL;var r=new Map;var h=function e(t){if(!t)return;if(t.url)return t.url;try{var a=r.get(t);if(!a){a=window.URL.createObjectURL(t);r.set(t,a)}return a}catch(e){console.log(e);return}};var g=function(e){(0,d.default)(o,e);var r=v(o);function o(){var e;(0,s.default)(this,o);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];e=r.call.apply(r,[this].concat(a));(0,c.default)((0,i.default)(e),"revoke",function(){if(e.props.src||e.props.file&&e.props.file.url)return;try{window.URL.revokeObjectURL(h(e.props.file))}catch(e){console.error(e)}});return e}(0,l.default)(o,[{key:"render",value:function e(){var t=this.props.src||h(this.props.file);return m.default.createElement("div",{className:p.default.img,style:{backgroundImage:'url("'.concat(t,'")')},onLoad:this.revoke},!t&&m.default.createElement("div",{className:p.default.loading},m.default.createElement(f.ActivityIndicator,null)))}}]);return o}(m.default.Component);t.default=g;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var u=n(a("./common/temp/node_modules/react/index.js"));var c=n(a("./common/temp/node_modules/classnames/index.js"));var m=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));var p=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Icon.js"));var f=a("./src/main/webapp/universal/packages/enums/JobStatuses.js");var v=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.less"));function h(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,d.default)(n),t;if(r()){var a=(0,d.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,i.default)(this,t)}}var g=function(e){(0,l.default)(a,e);var t=h(a);function a(){(0,r.default)(this,a);return t.apply(this,arguments)}(0,o.default)(a,[{key:"renderBadge",value:function e(){var t=this.props,a=t.uploadStatus,n=t.jobStatus;if(a===f.FAILURE||n===f.FAILURE)return u.default.createElement("div",{className:(0,c.default)(v.default.badge,v.default.failed)},u.default.createElement(p.default,{name:"error",height:22,width:22}));return null}},{key:"render",value:function e(){var t=this.props,a=t.children,n=t.percent,r=t.itemIndex;var o=(r+1)%3===0;return u.default.createElement("div",{className:(0,c.default)(m.default.imageContainer,m.default.processing,(0,s.default)({},m.default.thirdImageContainer,o))},u.default.createElement("div",{className:v.default.innerContainer},u.default.createElement("div",{className:v.default.content},a),u.default.createElement("div",{className:v.default.progress,style:{width:"".concat(n,"%")}})),this.renderBadge())}}]);return a}(u.default.Component);var b=g;t.default=b;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.less":function(e,t,a){e.exports={content:"JobProcessingState-content-1vREc",innerContainer:"JobProcessingState-innerContainer-27-vL",progress:"JobProcessingState-progress-1yiX8",badge:"JobProcessingState-badge-etvkv",failed:"JobProcessingState-failed-3Be4u"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var d=n(a("./common/temp/node_modules/react/index.js"));var u=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.js"));var c=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/Image.js"));function m(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,i.default)(n),t;if(r()){var a=(0,i.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,l.default)(this,t)}}var p=function(e){(0,s.default)(a,e);var t=m(a);function a(){(0,r.default)(this,a);return t.apply(this,arguments)}(0,o.default)(a,[{key:"render",value:function e(){var t=this.props,a=t.image,n=t.itemIndex,r=t.file;return d.default.createElement(u.default,{uploadStatus:a.uploadStatus,jobStatus:a.jobStatus,percent:a.percent,itemIndex:n},d.default.createElement(c.default,{file:r,formattedWidths:null}))}}]);return a}(d.default.Component);t.default=p;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var p=n(a("./common/temp/node_modules/classnames/index.js"));var f=a("./common/temp/node_modules/@sqs/styles/variables/baseRosetta.js");var v=a("./common/temp/node_modules/@sqs/rosetta-icons/build/lib/index.js");var h=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var g=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var b=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));function I(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,o.default)(this,t)}}var y="MacIntel"===window.navigator.platform?"metaKey":"ctrlKey";var r=function(e){(0,d.default)(o,e);var r=I(o);function o(){var n;(0,s.default)(this,o);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n=r.call.apply(r,[this].concat(t));(0,c.default)((0,i.default)(n),"containerRef",m.default.createRef());(0,c.default)((0,i.default)(n),"delete",function(){n.props.delete(n.props.id,n.props.isImage)});(0,c.default)((0,i.default)(n),"handleClick",function(e){var t=false;var a=false;e[y]&&(t=true);e.shiftKey&&(a=true);n.props.onSelectImage(t,a)});return n}(0,l.default)(o,[{key:"componentDidUpdate",value:function e(t){var a=t.isSelected;!a&&this.props.isSelected&&this.scrollToIfNeeded()}},{key:"scrollToIfNeeded",value:function e(){try{var t=this.containerRef.current;if(!t)return;var a=t.offsetParent.scrollTop;var n=a+t.offsetParent.clientHeight;var r=t.offsetTop;var o=r+t.clientHeight;var s=0;if(o>n)s=o-n;else{if(!(r<a))return;s=r-a}t.offsetParent.scrollBy({top:s,behavior:"smooth"})}catch(e){}}},{key:"render",value:function e(){var t;var a=this.props,n=a.src,r=void 0===n?"":n,o=a.isSelected,s=a.className,l=void 0===s?"":s,i=a.mobileEditMode,d=a.isImage,u=a.processing;return m.default.createElement("div",{ref:this.containerRef,className:(0,p.default)(b.default.imageContainer,l,(t={},(0,c.default)(t,b.default.mobileEditMode,i),(0,c.default)(t,b.default.processing,u),t))},m.default.createElement("div",{className:b.default.innerContainer},m.default.createElement("div",{className:(0,p.default)(b.default.img,(0,c.default)({},b.default.isSelected,o)),"data-selectable":true,style:{backgroundImage:'url("'.concat(r,'")')},onClick:this.handleClick,role:"img"},m.default.createElement("button",{className:b.default.hiddenButtonForAccessibility},"Select image")),m.default.createElement("button",{className:b.default.delete,onClick:this.delete},m.default.createElement(v.Trash,{height:2*f.GRID_SIZE_PX,width:2*f.GRID_SIZE_PX,color:"red"})),!d&&m.default.createElement(v.Video,{color:h.colors.white,sx:{position:"absolute",top:1,left:1}}),!r&&m.default.createElement("div",{className:b.default.loading},m.default.createElement(g.ActivityIndicator,null))))}}]);return o}(m.default.Component);t.default=r;(0,c.default)(r,"defaultProps",{withoutDeleteButton:false});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/ImagePickerPanel.less":function(e,t,a){e.exports={overlay:"ImagePickerPanel-overlay-1so5o",modalWithoutMargin:"ImagePickerPanel-modalWithoutMargin-2jtEb",dragProxy:"ImagePickerPanel-dragProxy-2CNV3",body:"ImagePickerPanel-body-2fDNG",multiDeleteButton:"ImagePickerPanel-multiDeleteButton-34DKm",imagePicker:"ImagePickerPanel-imagePicker-R9RRb",addImageDropDown:"ImagePickerPanel-addImageDropDown-bG74p",popover:"ImagePickerPanel-popover-2qXXs",iconButton:"ImagePickerPanel-iconButton-2na4V",imageList:"ImagePickerPanel-imageList-1_eQA",draggedImage:"ImagePickerPanel-draggedImage-3WJBG",errorWhenLoading:"ImagePickerPanel-errorWhenLoading-1j92k",errorWhenRefreshing:"ImagePickerPanel-errorWhenRefreshing-3e0B1",dragSelectionContainer:"ImagePickerPanel-dragSelectionContainer-7fsea",mobileToolbarButton:"ImagePickerPanel-mobileToolbarButton-1Bq28",mobileToolbarTitle:"ImagePickerPanel-mobileToolbarTitle-GaUYS"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/VideoUploadModal.less":function(e,t,a){e.exports={urlEmbed:"VideoUploadModal-urlEmbed-1jObo",urlDescription:"VideoUploadModal-urlDescription-I5afg",errorText:"VideoUploadModal-errorText-3H35L"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var b=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var I=n(a("./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js"));var y=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var S=n(a("./common/temp/node_modules/@sqs/core-components/primitives/ErrorText.js"));var C=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var _=n(a("./common/temp/node_modules/@sqs/core-components/primitives/SegmentedRadio.js"));var j=n(a("./common/temp/node_modules/@sqs/core-components/primitives/Description.js"));var E=n(a("./common/temp/node_modules/@sqs/core-components/fields/EmbedField.js"));var P=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/VideoUploadModal.less"));var w=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));var o=function e(t){var a=t.videoUploadModalOpen,n=t.videoLink,r=t.embedType,o=t.embedCodeUploadOn,s=t.addMode,l=t.videoError,i=t.setVideoUploadModalStatus,d=t.onAddVideo,u=t.setEmbedType,c=t.handleUrlEmbedChange,m=t.disableVideoAddBtn;var p=s?(0,C.t)("Add"):(0,C.t)("Replace");var f=s?(0,C.t)("Add Video"):(0,C.t)("Replace Video");var v=(0,C.t)("Cancel");var h=["vimeo","youtube","animoto","wistia"];var g=(0,C.t)("Support videos from Youtube, Vimeo, Animoto or Wistia.");return b.default.createElement(y.Modal.Transition,null,a&&b.default.createElement(y.Modal,{onRequestClose:function e(){return i(false)},closeOnOverlayClicked:false},b.default.createElement(y.Modal.Overlay,null),b.default.createElement(y.Modal.Position,{position:"center"},b.default.createElement(y.Modal.Dialog,{width:"sizes.750"},b.default.createElement(I.default,null,b.default.createElement(I.default.Left,null,b.default.createElement(I.default.Button,{label:v,onClick:function e(){return i(false)}})),b.default.createElement(I.default.Center,null,b.default.createElement(I.default.Title,null,f)),b.default.createElement(I.default.Right,null,b.default.createElement(I.default.Button,{label:p,onClick:d,isDisabled:m}))),b.default.createElement("div",null,o?b.default.createElement(_.default,{options:[{label:(0,C.t)("Video URL"),value:w.default.URL},{label:(0,C.t)("Video Embed"),value:w.default.MANUAL}],value:r,onChange:u}):null,r===w.default.URL?b.default.createElement(b.default.Fragment,null,b.default.createElement(E.default,{allowVimeoBasicAuthorEmbed:true,className:P.default.urlEmbed,onChange:c,providers:h,placeholder:"https://...",value:{url:n}}),l?b.default.createElement(S.default,{className:P.default.errorText,errors:{message:(0,C.t)("Something went wrong!")}}):null,b.default.createElement(j.default,{className:P.default.urlDescription,text:g})):null)))))};o.propTypes={videoUploadModalOpen:r.default.bool.isRequired,videoLink:r.default.string.isRequired,embedType:r.default.string.isRequired,embedCodeUploadOn:r.default.bool.isRequired,addMode:r.default.bool.isRequired,videoError:r.default.bool.isRequired,setVideoUploadModalStatus:r.default.func.isRequired,onAddVideo:r.default.func.isRequired,setEmbedType:r.default.func.isRequired,handleUrlEmbedChange:r.default.func.isRequired};var s=o;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/slicedToArray.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var m=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var p=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var _=n(a("./common/temp/node_modules/react/index.js"));var f=n(a("./common/temp/node_modules/memoize-one/dist/memoize-one.esm.js"));var j=n(a("./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js"));var v=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Button.js"));var E=n(a("./common/temp/node_modules/@sqs/core-components/web/modals/ReviewingChangesModal.js"));var P=n(a("./common/temp/node_modules/@sqs/core-components/web/containers/PopOver.js"));var h=n(a("./common/temp/node_modules/lodash/debounce.js"));var w=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Upload.svg"));var D=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Search.svg"));var k=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Edit.svg"));var A=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Video.svg"));var R=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var g=a("./src/main/webapp/universal/packages/enums/JobStatuses.js");var b=n(a("./src/main/webapp/universal/src/shared/components/ReorderableGroup/index.jsx"));var I=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var x=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/ImagePickerPanel.less"));var y=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/index.js"));var r=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/index.js"));var S=n(a("./common/temp/node_modules/classnames/index.js"));var C=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/index.js"));var M=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/isMobile.js"));var O=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/index.js"));var T=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));var U=a("./src/main/webapp/universal/packages/enums/RecordType.js");var F=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/BetaFeaturesUtils.js"));var L=n(a("./src/main/webapp/universal/packages/enums/Flag.js"));function G(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,m.default)(n),t;if(r()){var a=(0,m.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,c.default)(this,t)}}var N=a("./src/main/webapp/universal/src/shared/components/DragSelection.jsx");var q=F.default.isFeatureEnabled(L.default.GALLERY_VIDEOS_71);var B=function(e){(0,i.default)(r,e);var n=G(r);function r(){var v;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];v=n.call.apply(n,[this].concat(t));(0,p.default)((0,l.default)(v),"state",{sourceDropDownAnchor:null,isDraggingImages:false,hasFailed:false,mobileEditMode:false,videoUploadModalOpen:false,embedType:T.default.URL,videoLink:"",oembed:null,embedCode:"",videoError:false,jobSet:new Set});(0,p.default)((0,l.default)(v),"addImageBtnRef",_.default.createRef());(0,p.default)((0,l.default)(v),"failures",[]);(0,p.default)((0,l.default)(v),"uploaderRef",_.default.createRef());(0,p.default)((0,l.default)(v),"container",_.default.createRef());(0,p.default)((0,l.default)(v),"openSourceDropDown",function(e){var t="BUTTON"===e.target.tagName?e.target:e.target.closest("button");v.setState({sourceDropDownAnchor:t})});(0,p.default)((0,l.default)(v),"onRequestCloseSourceDropDown",function(){v.setState({sourceDropDownAnchor:null})});(0,p.default)((0,l.default)(v),"openLicensedImagePicker",function(){v.setState({sourceDropDownAnchor:null});v.props.uploader.openLicensedImagePicker()});(0,p.default)((0,l.default)(v),"openLocalImagePicker",function(){v.setState({sourceDropDownAnchor:null});v.props.uploader.openFileInput()});(0,p.default)((0,l.default)(v),"retryUpload",function(){var e=v.failures.map(function(e){var t=e.token;var a=v.props.uploadingFilesMap.get(t);v.props.removeFromUploadList(t);return a});v.props.uploader.onFileUploaderChanges(e);v.failures=[];v.setState({hasFailed:false})});(0,p.default)((0,l.default)(v),"clearFailures",function(){v.failures.forEach(function(e){v.props.removeFromUploadList(e.token);e.uploadStatus===g.FAILURE&&v.props.cancelUpload(e.token);e.jobStatus===g.FAILURE&&v.props.cancelJob(e.data.data.job.id)});v.failures=[];v.setState({hasFailed:false})});(0,p.default)((0,l.default)(v),"getItemNodesForDragSelection",function(){if(!v.container.current)return;return Array.from(v.container.current.querySelectorAll('[data-selectable="true"]'))});(0,p.default)((0,l.default)(v),"onDragSelectionChange",function(e){var t=e.added,a=e.removed;v.props.onSelectImages([].concat((0,u.default)(t),(0,u.default)(a)),v.state.mobileEditMode,true)});(0,p.default)((0,l.default)(v),"onDragSelectionMouseDown",function(e){e.metaKey||e.ctrlKey||e.shiftKey||v.props.clearSelection()});(0,p.default)((0,l.default)(v),"renderUploading",function(t,e){var a=v.props.uploads.find(function(e){return e.token===t.uploadToken});return _.default.createElement(C.default,{image:a,file:a.file,itemIndex:e})});(0,p.default)((0,l.default)(v),"checkJob",function(a){var e=v.props,n=e.finishedJobs,t=e.onChange;a?v.setState(function(e){var t=e.jobSet;t.add(a);return{jobSet:t}}):v.state.jobSet.size>0&&v.setState(function(e){var t=e.jobSet;t.forEach(function(e){n.includes(e)&&t.delete(e)});return{jobSet:t}},(0,h.default)(function(){0===v.state.jobSet.size&&t()},250))});(0,p.default)((0,l.default)(v),"renderImage",function(n,e,t,a){var r=v.state,o=r.isDraggingImages,s=r.mobileEditMode;var l=v.props,i=l.onSelectImages,d=l.deleteItem,u=l.selectedIds,c=l.items;if(n.uploadToken)return v.renderUploading(n,a);var m=c.find(function(e){return e.id===n.contentItemId});var p=m.jobId?"":m.assetUrl;v.checkJob(m.jobId);var f=u.find(function(e){return m.id===e});return _.default.createElement(y.default,{src:p,className:t.isDragging||o&&f?x.default.draggedImage:void 0,isSelected:u.find(function(e){return m.id===e}),delete:d,id:m.id,onSelectImage:function e(t,a){i([n],s,t,a)},mobileEditMode:s,isImage:m.recordType===U.IMAGE,processing:m.jobId})});(0,p.default)((0,l.default)(v),"checkFailure",function(e){v.failures=[];e.forEach(function(t){if(t.uploadToken){var e=v.props.uploads.find(function(e){return e.token===t.uploadToken});e&&(e.uploadStatus===g.FAILURE||e.jobStatus===g.FAILURE)&&v.props.uploadingFilesMap.get(e.token)&&v.failures.push(e)}});v.setState({hasFailed:v.failures.length>0})});(0,p.default)((0,l.default)(v),"getRenderingItems",function(t){var e=t.itemsMap.filter(function(e){if(e.uploadToken)return!!t.uploadingFilesMap.get(e.uploadToken);return true});return e});(0,p.default)((0,l.default)(v),"getReorderableGroupItems",(0,f.default)(function(e,t,a){t(e.itemsMap);return a(e)}));(0,p.default)((0,l.default)(v),"switchToMobileEditMode",function(){v.setState({mobileEditMode:true,sourceDropDownAnchor:null})});(0,p.default)((0,l.default)(v),"handleMobileButtonClicked",function(e){v.state.mobileEditMode?v.setState({mobileEditMode:false}):v.openSourceDropDown(e)});(0,p.default)((0,l.default)(v),"onReorder",function(e,t){var a=v.props,n=a.items,r=a.onChange;var o=(0,u.default)(e);o.sort(function(e,t){var a=(0,d.default)(e,2),n=a[0],r=a[1];var o=(0,d.default)(t,2),s=o[0],l=o[1];return r>l?1:-1});var s=o[0][1];var l;s>0&&(l=n[s-1].id);var i=o.map(function(e){var t=(0,d.default)(e,1),a=t[0];return a.contentItemId});I.default.reorderItems(v.props.galleryId,i,l,t.map(function(e){var t=e.contentItemId;return t})).then(function(){r()}).catch(function(e){return console.log(e)})});(0,p.default)((0,l.default)(v),"getSelectedData",function(e,a){var t=e.map(function(t){return a.find(function(e){return e.contentItemId===t})});return t});(0,p.default)((0,l.default)(v),"renderImageList",function(){var e=v.props,a=e.selectedIds,t=e.itemsMap;var n=v.state,r=n.mobileEditMode,o=n.isDraggingImages;var s=(0,S.default)(x.default.imageList,{"edit-on":r,"edit-off":!r,dragging:o});return _.default.createElement(_.default.Fragment,null,_.default.createElement(b.default,{watchExtraChildItems:true,className:s,proxyClassName:x.default.dragProxy,childItems:v.getReorderableGroupItems(v.props,v.checkFailure,v.getRenderingItems),childItemRenderer:v.renderImage,getChildKeyFromItem:function e(t){return t.key},onDragEnd:function e(){v.setState({isDraggingImages:false})},onDragStart:function e(t){if(!a.find(function(e){return e&&e===t.contentItemId})){v.props.clearSelection();v.props.onSelectImages([t],v.state.mobileEditMode,false)}v.setState({isDraggingImages:true})},onReorder:v.onReorder,itemsToMultiReorder:v.getSelectedData(a,t)}),_.default.createElement("div",{className:x.default.dragSelectionContainer},_.default.createElement(N,{key:"dragSelection",items:v.getRenderingItems(v.props),itemNodesGetter:v.getItemNodesForDragSelection,onMouseDown:v.onDragSelectionMouseDown,onSelectionChange:v.onDragSelectionChange,onDragEnd:v.props.resetSelection})))});(0,p.default)((0,l.default)(v),"setVideoUploadModalStatus",function(e){v.setState({videoUploadModalOpen:e,videoLink:"",oembed:null,embedCode:"",videoError:false})});(0,p.default)((0,l.default)(v),"setEmbedType",function(e){v.setState({embedType:e})});(0,p.default)((0,l.default)(v),"handleUrlEmbedChange",function(e){v.setState({oembed:e,videoLink:e.url||"",videoError:false})});(0,p.default)((0,l.default)(v),"handleEmbedCodeChange",function(e){var t={html:e,resolvedBy:T.default.MANUAL};v.setState({oembed:t,embedCode:e})});(0,p.default)((0,l.default)(v),"onAddVideo",function(){if(v.state.oembed&&v.state.oembed.resolved){v.props.uploadVideo(v.state.oembed,v.state.embedType);v.setVideoUploadModalStatus(false);v.setState({videoError:false})}else v.setState({videoError:true})});return v}(0,s.default)(r,[{key:"renderErrorIfNeeded",value:function e(t){var a=this.props.items;if(!t)return null;var n=(0,R.t)("Something went wrong.");var r=(0,R.t)("Reload");if(!a||!a.length)return _.default.createElement("div",{className:x.default.errorWhenLoading},_.default.createElement("p",null,n),t.reload?_.default.createElement(v.default,{color:"primary",onClick:t.reload},r):null);return _.default.createElement("div",{className:x.default.errorWhenRefreshing},_.default.createElement("p",null,n),t.reload?_.default.createElement(v.default,{color:"primary",onClick:t.reload},r):null)}},{key:"render",value:function e(){var t=this;var a=this.props,n=a.error,r=a.isInitialized,o=a.onRequestClose;var s=this.state,l=s.videoUploadModalOpen,i=s.videoLink,d=s.embedType,u=s.embedCode,c=s.videoError,m=s.oembed;var p=this.getRenderingItems(this.props);var f=p.length>0;var v=(0,R.t)("Drag to Reorder");var h=(0,R.t)("Gallery Manager");var g=(0,R.t)("Gallery");var b=(0,R.t)("Done");var I=(0,R.t)("Edit");var y=(0,R.t)("Close");var S=(0,M.default)()?this.state.mobileEditMode?v:h:g;var C=this.state.mobileEditMode?b:I;return _.default.createElement("div",{className:x.default.imagePicker,onDragEnter:this.onDragEnter},_.default.createElement(j.default,null,_.default.createElement(j.default.Left,null,_.default.createElement(j.default.Button,{className:x.default.mobileToolbarButton,label:y,onClick:o})),_.default.createElement(j.default.Center,null,_.default.createElement(j.default.Title,{className:x.default.mobileToolbarTitle},S)),_.default.createElement(j.default.Right,null,!(0,M.default)()&&_.default.createElement(j.default.IconButton,{ref:this.addImageBtnRef,name:"addBlock",onClick:this.openSourceDropDown}),(0,M.default)()&&_.default.createElement(j.default.Button,{label:C,onClick:this.handleMobileButtonClicked,className:x.default.mobileToolbarButton}))),this.state.sourceDropDownAnchor&&_.default.createElement(P.default,{anchor:this.state.sourceDropDownAnchor,hideArrow:true,position:"bottom",isOpen:true,closeOnClickOutside:true,bodyClassName:x.default.popover,onRequestClose:this.onRequestCloseSourceDropDown},(0,M.default)()&&_.default.createElement("button",{className:x.default.iconButton,onClick:this.switchToMobileEditMode},_.default.createElement("img",{className:x.default.editIcon,src:k.default,alt:""}),_.default.createElement("p",{className:x.default.iconText},(0,R.t)("Manage Images"))),!(0,M.default)()&&_.default.createElement("button",{className:x.default.iconButton,onClick:this.openLicensedImagePicker},_.default.createElement("img",{className:x.default.searchIcon,src:D.default,alt:""}),_.default.createElement("p",{className:x.default.iconText},(0,R.t)("Search Images"))),_.default.createElement("button",{className:x.default.iconButton,onClick:this.openLocalImagePicker},_.default.createElement("img",{className:x.default.uploadIcon,src:w.default,alt:""}),_.default.createElement("p",{className:x.default.iconText},(0,R.t)("Upload Images"))),q&&_.default.createElement("button",{className:x.default.iconButton,onClick:function e(){return t.setVideoUploadModalStatus(true)}},_.default.createElement("img",{className:x.default.videoIcon,src:A.default,alt:""}),_.default.createElement("p",{className:x.default.iconText},(0,R.t)("Add Video")))),_.default.createElement("div",{className:x.default.body,ref:this.container},r&&this.renderImageList(),!n&&r?this.props.uploader.renderOverlayIfPossible(f):null,this.renderErrorIfNeeded(n)),_.default.createElement(E.default,{title:(0,R.t)("Something went wrong"),message:(0,R.t)("Your images failed to upload"),saveLabel:(0,R.t)("Try Again"),cancelLabel:(0,R.t)("Cancel"),discardLabel:(0,R.t)("Delete Image"),cancelStyle:"default",confirmStyle:"default",isReviewingChanges:this.state.hasFailed,onSave:this.retryUpload,onDismiss:this.clearFailures,onDiscard:this.clearFailures,onRequestClose:this.clearFailures}),_.default.createElement(O.default,{videoUploadModalOpen:l,setVideoUploadModalStatus:this.setVideoUploadModalStatus,setEmbedType:this.setEmbedType,onAddVideo:this.onAddVideo,handleEmbedCodeChange:this.handleEmbedCodeChange,handleUrlEmbedChange:this.handleUrlEmbedChange,embedCodeUploadOn:false,videoLink:i,embedType:d,embedCode:u,addMode:true,videoError:c,disableVideoAddBtn:!(null===m||void 0===m?void 0:m.url)}))}}]);return r}(_.default.Component);var V=(0,r.default)(B);var z=V;t.default=z;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var r=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var c=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var o=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var d=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var p=n(a("./common/temp/node_modules/react/index.js"));var f=r(a("./common/temp/node_modules/lodash/last.js"));var v=r(a("./common/temp/node_modules/lodash/compact.js"));var h=r(a("./common/temp/node_modules/lodash/debounce.js"));var g=r(a("./common/temp/node_modules/prop-types/index.js"));var b=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var I=r(a("./common/temp/node_modules/@sqs/core-components/lib/web/ConfirmModal.js"));var y=r(a("./src/main/webapp/universal/src/shared/utils/Keyboard.js"));var S=r(a("./common/temp/node_modules/classnames/index.js"));var C=a("./src/main/webapp/universal/src/shared/constants/UploadMaxSize.js");var _=a("./src/main/webapp/universal/src/shared/constants/UploadMimeTypes.js");var j=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/PageSectionsActions.js"));var E=r(a("./src/main/webapp/universal/src/apps/App/shared/stores/ContentItemStore.js"));var P=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var w=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js"));var D=r(a("./src/main/webapp/universal/src/shared/stores/UploadStore.js"));var k=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/index.js"));var A=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/index.js"));var R=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.less"));var x=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/errors.js");var M=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/deleteMessages.js"));var O=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContextProvider.js"));var T=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/makeCancellable.js");var U=a("./src/main/webapp/universal/packages/enums/RecordType.js");function F(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function L(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?F(Object(a),true).forEach(function(e){(0,m.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function G(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,d.default)(this,t)}}var N=230;var q=function(e){(0,i.default)(r,e);var n=G(r);function r(){var u;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];u=n.call.apply(n,[this].concat(t));(0,m.default)((0,l.default)(u),"state",{galleryId:u.props.galleryId,uploadingFilesMap:new Map,shouldDelete:null,deletionMessages:{},dropZoneEnabled:false,isInitialized:false,storedSection:null,isBackspaceToDeleteEnabled:true,mobileSwitchToContent:false,mobileShowDetail:false,selectedIds:[],dirtyMap:new Map});(0,m.default)((0,l.default)(u),"lastSelectedId",null);(0,m.default)((0,l.default)(u),"dropzonePortalContainerRef",p.default.createRef());(0,m.default)((0,l.default)(u),"setViewportHeight",function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))});(0,m.default)((0,l.default)(u),"handleKeyUp",function(e){y.default.isBackspaceKey(e)&&u.state.isBackspaceToDeleteEnabled&&document.activeElement===document.body&&u.deleteSelectedImages()});(0,m.default)((0,l.default)(u),"setIsBackspaceToDeleteEnabled",function(e){u.setState({isBackspaceToDeleteEnabled:e})});(0,m.default)((0,l.default)(u),"loadImages",(0,T.withCanceledState)(function(e){var t=e.makeCancelablePromise,a=e.makeCancelableCallback;return function(){if(!u.props.galleryId)return;u.loadImageTimeout=setTimeout(a(function(){if(!u.props.galleryId)return;w.default.loadStart();u.setState({isInitialized:false,error:null});E.default.fetchForCollection(u.props.galleryId).then(function(){w.default.loadSuccess({collectionId:u.props.galleryId,contentItems:u.props.items,uploads:D.default.getCurrentUploadsForCollection(u.props.galleryId)});u.setState({isInitialized:true,selectedIds:u.initSelection(u.props.items)})}).catch(function(e){w.default.loadFailure({collectionId:u.props.galleryId,error:e});u.setState({error:{type:x.FAILED_TO_LOAD_IMAGES,reload:u.loadImages}})})}),10)}}));(0,m.default)((0,l.default)(u),"initSelection",function(e){if(0===u.state.selectedIds.length&&e.length){u.lastSelectedId={id:e[0].id,isSelected:true};return[e[0].id]}return[]});(0,m.default)((0,l.default)(u),"onRequestClose",function(){var e=u.state.storedSection;if(!e)return;u.lastSelectedId=null;u.saveItemDetailsIfDirty();j.default.setIsGalleryContentEditorOpen({isGalleryContentEditorOpen:false});u.setState({sourceDropDownPosition:null,selectedIds:[],dropZoneEnabled:false,storedSection:null,dirtyMap:new Map})});(0,m.default)((0,l.default)(u),"handleOnChange",function(){var e=u.props.section;j.default.setSectionSettings(L({sectionId:e.id},e||{},{galleryOptions:L({},e.galleryOptions,{lastUpdate:Date.now()})}))});(0,m.default)((0,l.default)(u),"deleteItem",function(e,t){var a=t?"image":"video";u.setState({shouldDelete:e,deletionMessages:{title:M.default.singleTitle[a],message:M.default.singleDetail[a]}})});(0,m.default)((0,l.default)(u),"deleteSelectedImages",function(){if(!u.state.selectedIds.length)return;var e=u.state.selectedIds;var t=u.getDeleteTypeText();u.setState({shouldDelete:e,deletionMessages:{title:M.default.multipleTitle[t],message:M.default.multipleDetail[t]}})});(0,m.default)((0,l.default)(u),"doDeleteImages",(0,T.withCanceledState)(function(e){var t=e.makeCancelablePromise;return function(){var e=u.state.shouldDelete;if(null===e)return;Array.isArray(e)?t(P.default.deleteMany(e)).then(function(){u.setState({selectedIds:[]});u.handleOnChange()}):t(P.default.delete(e)).then(function(){u.setState(function(e){var t=e.selectedIds;return{selectedIds:1===t.length?[]:t}});u.handleOnChange()});u.setState({shouldDelete:null})}}));(0,m.default)((0,l.default)(u),"getDeleteTypeText",function(){var t=0;var a=u.state.selectedIds;var e=u.props.items.filter(function(e){return a.includes(e.id)});e.forEach(function(e){e.recordType!==U.IMAGE&&t++});var n=t===a.length?"video":0===t?"image":"mixed";return n});(0,m.default)((0,l.default)(u),"cancelDeletion",function(){u.setState({shouldDelete:null})});(0,m.default)((0,l.default)(u),"addFileToUploadList",function(a,n){u.setState(function(e){var t=e.uploadingFilesMap;t.set(a,n);return{uploadingFilesMap:t}})});(0,m.default)((0,l.default)(u),"removeFromUploadList",function(a){u.setState(function(e){var t=e.uploadingFilesMap;t.delete(a);return{uploadingFilesMap:t}})});(0,m.default)((0,l.default)(u),"onImageDetailChanges",function(a){1===u.state.selectedIds.length&&u.setState(function(e){var t=e.dirtyMap;t.set(a.id,a);return{dirtyMap:t}})});(0,m.default)((0,l.default)(u),"handleFocalPointChange",function(e){u.state.selectedIds&&1===u.state.selectedIds.length&&u.updateField(u.state.selectedIds[0],"mediaFocalPoint",e)});(0,m.default)((0,l.default)(u),"updateField",(0,h.default)(function(e,t,a){P.default.updateField(e,t,a).then(function(){u.handleOnChange()})},250));(0,m.default)((0,l.default)(u),"clearDirtyMap",function(){u.setState({dirtyMap:new Map})});(0,m.default)((0,l.default)(u),"saveItemDetailsIfDirty",function(){if(0===u.state.dirtyMap.size)return;var e=Array.from(u.state.dirtyMap.values());P.default.updateForCollection(e[0]).then(function(){u.handleOnChange()});u.clearDirtyMap()});(0,m.default)((0,l.default)(u),"onGalleryIdChanges",function(e){j.default.setSectionSettings(L({sectionId:u.props.section.id},u.props.section||{},{galleryOptions:L({},u.props.section.galleryOptions,{transientGalleryId:e})}))});(0,m.default)((0,l.default)(u),"onSelectImages",function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=Array.isArray(e)?e:[e];var r=e.map(function(e){return null===e||void 0===e?void 0:e.contentItemId});var o=u.state.selectedIds?(0,c.default)(u.state.selectedIds):[];u.saveItemDetailsIfDirty();if(n&&1===e.length&&r.length&&null!==u.lastSelectedId){u.onSelectImagesRange(e[0]);return}if(a){u.lastSelectedId={id:(0,f.default)(r),isSelected:!o.includes((0,f.default)(r))};r.forEach(function(t){var e=o.includes(t);e?o=o.filter(function(e){return e!==t}):o.push(t)})}else{o=r;u.lastSelectedId={id:(0,f.default)(o),isSelected:true}}u.setState({selectedIds:(0,v.default)(o)});!t&&u.mobileShowDetail&&u.setState({mobileSwitchToContent:true})});(0,m.default)((0,l.default)(u),"onSelectImagesRange",function(e){var t=u.state.selectedIds;var a=u.props.items;var n=(0,c.default)(t);var r=e.contentItemId;var o=a.findIndex(function(e){return u.lastSelectedId.id===e.id});var s=a.findIndex(function(e){return r===e.id});if(-1===o||-1===s)return null;var l=a.slice(Math.min(o,s),Math.max(o,s)+1);var i=l.map(function(e){return e.id});if(u.lastSelectedId.isSelected&&!n.includes(r)){var d=i.filter(function(e){return!t.includes(e)});n=[].concat(n,d)}else n=n.filter(function(e){return!i.includes(e)});u.lastSelectedId.id=r;u.setState({selectedIds:(0,v.default)(n)})});(0,m.default)((0,l.default)(u),"clearSelection",function(){u.saveItemDetailsIfDirty();u.lastSelectedId=null;u.setState({selectedIds:[]})});(0,m.default)((0,l.default)(u),"resetSelection",function(){var e,t;if(u.state.selectedIds&&u.state.selectedIds.length)return;var a=[null===(e=u.props.items[0])||void 0===e?void 0:e.id];u.lastSelectedId={id:null===(t=u.props.items[0])||void 0===t?void 0:t.id,selected:true};u.setState({selectedIds:(0,v.default)(a)})});(0,m.default)((0,l.default)(u),"isFirstImageSelected",function(){var e;return 1===u.state.selectedIds.length&&u.state.selectedIds[0]===(null===(e=u.props.items[0])||void 0===e?void 0:e.id)});(0,m.default)((0,l.default)(u),"isLastImageSelected",function(){var e;return 1===u.state.selectedIds.length&&u.state.selectedIds[0]===(null===(e=u.props.items[u.props.items.length-1])||void 0===e?void 0:e.id)});(0,m.default)((0,l.default)(u),"selectPreviousImage",function(){if(!u.isFirstImageSelected()){u.saveItemDetailsIfDirty();u.setState(function(e){var t=e.selectedIds;var a=u.props.items;var n=Math.max(0,a.findIndex(function(e){return t[0]===e.id})-1);return{selectedIds:[a[n].id]}})}});(0,m.default)((0,l.default)(u),"selectNextImage",function(){if(!u.isLastImageSelected()){u.saveItemDetailsIfDirty();u.setState(function(e){var t=e.selectedIds;var a=u.props.items;var n=Math.min(a.length-1,a.findIndex(function(e){return t[0]===e.id})+1);return{selectedIds:[a[n].id]}})}});(0,m.default)((0,l.default)(u),"onDragEnter",function(){return u.setState({dropZoneEnabled:true})});(0,m.default)((0,l.default)(u),"disableDropZone",function(){return u.setState({dropZoneEnabled:false})});(0,m.default)((0,l.default)(u),"mobileSwitchToPicker",function(){u.setState({mobileSwitchToContent:false})});return u}(0,s.default)(r,[{key:"componentDidMount",value:function e(){this.loadImages();document.addEventListener("keyup",this.handleKeyUp);window.addEventListener("resize",this.setViewportHeight);this.setViewportHeight()}},{key:"componentDidUpdate",value:function e(t){t.galleryId!==this.props.galleryId&&this.loadImages()}},{key:"getSnapshotBeforeUpdate",value:function e(t){var a=this;t.isGalleryContentEditorOpen&&!this.props.isGalleryContentEditorOpen&&this.state.storedSection&&(this.cleanupFallbackTimeout=setTimeout(function(){a.onRequestClose()}));return null}},{key:"componentWillUnmount",value:function e(){if(this.cleanupFallbackTimeout){clearTimeout(this.cleanupFallbackTimeout);this.cleanupFallbackTimeout=null}if(this.loadImageTimeout){clearTimeout(this.loadImageTimeout);this.loadImageTimeout=null}this.loadImages.cancel();this.updateField.cancel();this.doDeleteImages.cancel();document.removeEventListener("keyup",this.handleKeyUp);this.lastSelectedId=null;window.removeEventListener("resize",this.setViewportHeight)}},{key:"render",value:function e(){var t=this.props,a=t.isGalleryContentEditorOpen,n=t.galleryId,r=t.items,o=t.uploads,s=t.itemsMap,l=t.finishedJobs;return p.default.createElement(b.Modal.Transition,{duration:N},a&&p.default.createElement(b.Modal,{className:R.default.noPointerEvents,lockScroll:false,closeOnEsc:true,closeOnOverlayClicked:true,onRequestClose:this.onRequestClose},p.default.createElement(b.Modal.Overlay,{className:R.default.noPointerEvents}),p.default.createElement(b.Modal.Position,{className:R.default.noPointerEvents,draggable:true,position:"center",constrainTo:"window"},p.default.createElement(b.Modal.Dialog,{className:R.default.dialogContainer},p.default.createElement("div",{onDragEnter:this.onDragEnter,className:R.default.innerContainer},p.default.createElement(O.default,{collectionId:n,items:r,maxFileSizeMb:C.MAX_SIZE,validMimeTypes:_.IMAGE_MIME_TYPES,onCollectionIdCreated:this.onGalleryIdChanges,onStartUploadingFile:this.addFileToUploadList,handleOnChange:this.handleOnChange,uploadingFilesMap:this.state.uploadingFilesMap,dropzonePortalContainerRef:this.dropzonePortalContainerRef,dirtyMap:this.state.dirtyMap,clearDirtyMap:this.clearDirtyMap},p.default.createElement("div",{className:(0,S.default)(R.default.panel,(0,m.default)({},R.default.hide,this.state.mobileSwitchToContent))},p.default.createElement(k.default,{isInitialized:this.state.isInitialized,galleryId:n,onRequestClose:this.onRequestClose,onChange:this.handleOnChange,onGalleryIdChanges:this.onGalleryIdChanges,onSelectImages:this.onSelectImages,clearSelection:this.clearSelection,resetSelection:this.resetSelection,selectedIds:this.state.selectedIds,deleteItem:this.deleteItem,items:r,uploadingFilesMap:this.state.uploadingFilesMap,removeFromUploadList:this.removeFromUploadList,dropZoneEnabled:this.state.dropZoneEnabled,disableDropZone:this.disableDropZone,error:this.state.error,mobileHidePicker:this.state.mobileSwitchToContent,uploads:o,itemsMap:s,finishedJobs:l})),p.default.createElement("div",{className:R.default.panel},p.default.createElement(A.default,{selectedIds:this.state.selectedIds,items:r,deleteSelectedImages:this.deleteSelectedImages,selectPreviousImage:this.selectPreviousImage,selectNextImage:this.selectNextImage,isFirstImage:this.isFirstImageSelected(),isLastImage:this.isLastImageSelected(),delete:this.deleteSelectedImages,onImageDetailChanges:this.onImageDetailChanges,onFocalPointChange:this.handleFocalPointChange,setIsBackspaceToDeleteEnabled:this.setIsBackspaceToDeleteEnabled,mobileSwitchToPicker:this.mobileSwitchToPicker,itemsMap:s,dirtyMap:this.state.dirtyMap})),p.default.createElement(I.default,{isOpen:null!==this.state.shouldDelete,title:this.state.deletionMessages.title,message:this.state.deletionMessages.message,onConfirm:this.doDeleteImages,onDismiss:this.cancelDeletion,onRequestClose:this.cancelDeletion,cancelStyle:"default",confirmStyle:"default"}),p.default.createElement("div",{ref:this.dropzonePortalContainerRef})))))))}}],[{key:"getDerivedStateFromProps",value:function e(t,a){var n=null;if(t.section&&(!a.storedSection||t.section.id!==a.storedSection.id)){n=n||{};n.storedSection=t.section}if(t.galleryId!==a.galleryId){n=n||{};n.galleryId=t.galleryId;n.isInitialized=!t.galleryId;n.error=null;n.storedSection=t.section}return n}}]);return r}(p.Component);t.default=q;(0,m.default)(q,"propTypes",{isGalleryContentEditorOpen:g.default.bool.isRequired,cloneable:g.default.bool});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.less":function(e,t,a){e.exports={noPointerEvents:"PageSectionGalleryContent-noPointerEvents-2uJKN",dialogContainer:"PageSectionGalleryContent-dialogContainer-1HszE",innerContainer:"PageSectionGalleryContent-innerContainer-G0GCZ",panel:"PageSectionGalleryContent-panel-h9Zy2",hide:"PageSectionGalleryContent-hide-N5_bK"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var o=n(a("./common/temp/node_modules/alt-utils/lib/connectToStores.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.js"));var l=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/PageSectionsStore.js"));var i=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/FooterSectionsStore.js"));var p=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionSettings/utils/StoreUtils.js");var f=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/ContentItemStore.js"));var d=n(a("./src/main/webapp/universal/src/shared/stores/JobStore.js"));var u=n(a("./src/main/webapp/universal/src/shared/stores/UploadStore.js"));var v=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/GalleryStore.js"));var c=n(a("./common/temp/node_modules/lodash/isNumber.js"));var m=n(a("./common/temp/node_modules/lodash/get.js"));function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),true).forEach(function(e){(0,r.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var b=function e(t,a){if(!t||!a)return null;return t.find(function(e){return e.id===a})};var I=function e(t){var i=d.default.getState();if(!t)return{};var a=Object.values(u.default.getState()).filter(function(e){return e&&e.data.collectionId===t}).map(function(e){var t=e.file;var a=e.status;var n;var r;(0,m.default)(e,["data","job","id"])?r=e.data.job&&e.data.job:(0,m.default)(e,["data","data","job","id"])&&(r=e.data.data.job);if(r){var o=r.id;var s=i[o];s?n=s.status:(0,c.default)(r.status)&&(n=r.status)}!t&&(0,m.default)(e,["data","data","fileData"])&&(t=e.data.data.fileData);!t&&(0,m.default)(e,["data","data","fileUrl"])&&(t={url:e.data.data.fileUrl});var l=e.data.index;return g({},e,{uploadStatus:a,jobStatus:n,file:t,displayIndex:l})});return a};var y=(0,o.default)({getStores:function e(){return[l.default,f.default,d.default,u.default,v.default,i.default]},getPropsFromStores:function e(){var t=(0,p.getSectionStore)(),a=t.isGalleryContentEditorOpen,n=t.sectionId,r=t.sections;var o=v.default.getState(),s=o.items,l=o.finishedJobs;var i=b(r,n);var d=i&&i.galleryOptions&&i.galleryOptions.transientGalleryId;var u=Object.values(f.default.getState().toJS());u.sort(function(e,t){return e.displayIndex>t.displayIndex?1:-1});var c=u.filter(function(e){return e&&e.collectionId===d});var m=I(d);return{isGalleryContentEditorOpen:a,section:i,galleryId:d,items:c,itemsMap:s,uploads:m,finishedJobs:l}}},s.default);t.default=y;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/react/index.js"));var o=n(a("./common/temp/node_modules/lodash/noop.js"));var s=r.default.createContext({uploadFiles:o.default,validateFiles:o.default});var l=s;t.default=l;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContextProvider.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var r=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var d=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=r(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var m=r(a("./common/temp/node_modules/react/index.js"));var p=r(a("./common/temp/node_modules/prop-types/index.js"));var v=r(a("./common/temp/node_modules/lodash/uniqueId.js"));var h=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var g=r(a("./src/main/webapp/universal/src/shared/utils/buildUploadPostData.js"));var b=a("./src/main/webapp/universal/src/shared/utils/uploadToken.js");var I=r(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var y=r(a("./src/main/webapp/universal/src/shared/constants/UploadModes.js"));var S=r(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var C=a("./src/main/webapp/universal/packages/enums/RecordType.js");var _=a("./src/main/webapp/universal/src/shared/utils/UploadAPI.js");var j=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentCollectionActions.js"));var E=r(a("./src/main/webapp/universal/packages/enums/CollectionTypes.js"));var P=r(a("./src/main/webapp/universal/packages/enums/CollectionOrdering.js"));var w=r(a("./src/main/webapp/universal/packages/enums/WorkflowStates.js"));var D=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/MediaUploadService.js"));var k=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var A=r(a("./src/main/webapp/universal/src/apps/App/shared/utils/ContentItemAPI.js"));var f=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));var R=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/videoDataSchema.js"));var x=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));function M(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function O(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?M(Object(a),true).forEach(function(e){(0,c.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function T(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,d.default)(this,t)}}var U=function(e){(0,i.default)(r,e);var n=T(r);function r(){var f;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];f=n.call.apply(n,[this].concat(t));(0,c.default)((0,l.default)(f),"fileInputRef",m.default.createRef());(0,c.default)((0,l.default)(f),"getUploadData",function(e,t,a){return(0,g.default)(e,a?C.VIDEO:C.IMAGE,y.default.ITEM,t)});(0,c.default)((0,l.default)(f),"createNewCollection",function(){var e=(0,h.t)("Transient Gallery {galleryId}",{galleryId:(0,v.default)()});return j.default.create({type:E.default.GALLERY_BLOCK,ordering:P.default.USER,typeName:"transient-gallery",navigationTitle:e})});(0,c.default)((0,l.default)(f),"uploadFromFileUrl",function(t,a,e){var n=f.props,r=n.items,o=n.collectionId,s=void 0===o?e:o,l=n.onCollectionIdCreated,i=n.onStartUploadingFile;if(!s){f.createNewCollection().then(function(e){l(e);f.uploadFromFileUrl(t,a,e)});return}var d=f.getLastItemDisplayIndex(r);var u=(0,b.getUploadToken)();var c=f.getUploadData(a,{index:d+1,collectionId:s},false);i(u,{url:t});I.default.uploadFromFileUrl(u,_.URLS.GALLERY_IMAGE(s),c)});(0,c.default)((0,l.default)(f),"uploadFiles",function(t,e){var a=f.props,n=a.items,r=a.collectionId,o=void 0===r?e:r,s=a.onCollectionIdCreated,l=a.onStartUploadingFile;if(!o){f.createNewCollection().then(function(e){s(e);f.uploadFiles(t,e)});return}var i=(0,b.getMultipleUploadTokens)(t.length);var d=t.map(function(e,t){l(i[t],e);var a=f.getLastItemDisplayIndex(n);return f.getUploadData(e,{index:a+t+1,collectionId:o},false)});if((0,D.isMediaUploadServiceEnabled)())D.default.uploadFiles(i,d);else{var u=_.URLS.GALLERY_IMAGE(o);I.default.uploadFiles(i,u,d)}});(0,c.default)((0,l.default)(f),"uploadVideo",function(n,r,e){var t=f.props,a=t.items,o=t.collectionId,s=void 0===o?e:o,l=t.onCollectionIdCreated,i=t.onStartUploadingFile;if(!s){f.createNewCollection().then(function(e){l(e);f.uploadVideo(n,r,e)});return}var d=f.getLastItemDisplayIndex(a);var u=(0,b.getUploadToken)();var c=f.getUploadData(n,{index:d+1,collectionId:s},true);i(u,{url:n.thumbnailUrl});var m=(new Date).getTime();var p=O({},R.default,{addedOn:m,publishOn:m,collectionId:s,title:n.title,sourceUrl:n.url,displayIndex:d+1,structuredContent:O({},R.default.structuredContent,{oembed:n})},r===x.default.URL?{oembed:n}:{});A.default.createForCollection(p).then(function(e){var t=e.data;if(r===x.default.URL){var a=O({},c,{fileUrl:n.thumbnailUrl,collectionId:t.collectionId,replaceItemId:t.id});I.default.uploadFromFileUrl(u,_.URLS.VIDEO,a)}})});(0,c.default)((0,l.default)(f),"reuseImage",function(t,e){var a=f.props,n=a.collectionId,r=void 0===n?e:n,o=a.onCollectionIdCreated,s=a.handleOnChange;if(!r){f.createNewCollection().then(function(e){o(e);f.reuseImage(t,e)});return}A.default.copy(t,w.default.PUBLISHED,r).then(function(e){var t=e.data;k.default.insert(t);s()})});(0,c.default)((0,l.default)(f),"replaceImage",function(e,t){var a=f.props,n=a.dirtyMap,r=a.clearDirtyMap;var o=(0,b.getUploadToken)();var s=f.getUploadData(e,{index:t.displayIndex,collectionId:f.props.collectionId,replaceItemId:t.id});n.has(t.id)?k.default.updateForCollection(t).then(function(){r();f.doReplaceImage(o,e,s)}):f.doReplaceImage(o,e,s)});(0,c.default)((0,l.default)(f),"doReplaceImage",function(e,t,a){var n=f.props,r=n.onStartUploadingFile,o=n.collectionId;r(e,t);I.default.uploadFile(e,_.URLS.GALLERY_IMAGE(o),a)});(0,c.default)((0,l.default)(f),"getFileTooLargeError",function(e){return(0,h.t)("The file {name} is too large. The maximum allowed file size is {size}MB.",{name:e.name,size:f.props.maxFileSizeMb})});(0,c.default)((0,l.default)(f),"getInvalidTypeError",function(e){return(0,h.t)("The file {name} does not appear to be a supported image file.",{name:e.name})});(0,c.default)((0,l.default)(f),"getLastItemDisplayIndex",function(e){var t;if(e.length>0){t=e.length-1;"number"===typeof e[e.length-1].displayIndex&&(t=Math.max(e[e.length-1].displayIndex,e.length-1))}else t=0;return t});(0,c.default)((0,l.default)(f),"validateFiles",function(e){var t=f.props,a=t.maxFileSizeMb,n=t.validMimeTypes;var r={tooLarge:[],invalidType:[]};var o=[];var s=e.filter(function(e){if(e.size>1024*a*1024){r.tooLarge.push(e);return false}if(!n.includes(e.type)){r.invalidType.push(e);return false}return true});(r.tooLarge.length||r.invalidType)&&(o=f.generateErrorMessages(r));return{errors:r,invalidFilesErrors:o,validFiles:s}});(0,c.default)((0,l.default)(f),"cancelUpload",function(e){I.default.cancelUpload(e)});(0,c.default)((0,l.default)(f),"cancelJob",function(e){S.default.cancel(e)});(0,c.default)((0,l.default)(f),"contextValue",{validateFiles:f.validateFiles,uploadFiles:f.uploadFiles,uploadFromFileUrl:f.uploadFromFileUrl,uploadVideo:f.uploadVideo,reuseImage:f.reuseImage,replaceImage:f.replaceImage,cancelUpload:f.cancelUpload,cancelJob:f.cancelJob,dropzonePortalContainerRef:f.props.dropzonePortalContainerRef});return f}(0,s.default)(r,[{key:"generateErrorMessages",value:function e(t){var a=[].concat((t.tooLarge||[]).map(this.getFileTooLargeError),(t.invalidType||[]).map(this.getInvalidTypeError));return a.length?a.join("\n"):null}},{key:"render",value:function e(){return m.default.createElement(f.default.Provider,{value:this.contextValue},this.props.children)}}]);return r}(m.default.Component);t.default=U;(0,c.default)(U,"propTypes",{items:p.default.array.isRequired,uploadingFilesMap:p.default.object.isRequired,maxFileSizeMb:p.default.number.isRequired,onCollectionIdCreated:p.default.func.isRequired,onStartUploadingFile:p.default.func.isRequired,handleOnChange:p.default.func.isRequired,validMimeTypes:p.default.arrayOf(p.default.string).isRequired,collectionId:p.default.string});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/deleteMessages.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var r={singleTitle:{video:(0,n.t)("Remove Video"),image:(0,n.t)("Remove Image")},singleDetail:{video:(0,n.t)("Are you sure you wish to remove this video? This action cannot be undone."),image:(0,n.t)("Are you sure you wish to remove this image? This action cannot be undone.")},multipleTitle:{video:(0,n.t)("Remove Videos"),image:(0,n.t)("Remove Images"),mixed:(0,n.t)("Remove Images/Videos")},multipleDetail:{video:(0,n.t)("Are you sure you wish to remove selected videos? This action cannot be undone."),image:(0,n.t)("Are you sure you wish to remove selected images? This action cannot be undone."),mixed:(0,n.t)("Are you sure you wish to remove selected images/videos? This action cannot be undone.")}};var o=r;t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n={MANUAL:"manual",URL:"url"};var r=n;t.default=r;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/errors.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FAILED_TO_LOAD_IMAGES=void 0;var n="FAILED_TO_LOAD_IMAGES";t.FAILED_TO_LOAD_IMAGES=n},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/isMobile.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var r=a("./common/temp/node_modules/@sqs/rosetta-utilities/build/lib/index.js");var o=function e(){var t=(0,r.getBreakpoint)(n.breakpoints),a=t.platform;return"mobile"===a};t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/makeCancellable.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.withCanceledState=t.makeCancelableCallback=t.makeCancelablePromise=void 0;var n=function e(n){var r=false;var t=new Promise(function(t,a){n.then(function(e){return r?a({isCanceled:true}):t(e)},function(e){return a(r?{isCanceled:true}:e)})});return{promise:t,cancel:function e(){r=true}}};t.makeCancelablePromise=n;var r=function e(t){var a=false;var n=function e(){if(!a)return t.apply(void 0,arguments)};n.cancel=function(){a=true};return n};t.makeCancelableCallback=r;var o=function e(t){var o=false;var a=function e(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o)return;var t=new Promise(function(t,a){n.then(function(e){if(o){r&&a({isCanceled:true});return}t(e)},function(e){if(o){r&&a({isCanceled:true});return}a(e)})});return t};var n=function e(t){var a=function e(){if(!o)return t.apply(void 0,arguments)};a.cancel=function(){o=true};return a};t.cancel=function(){o=true};return n(t({makeCancelablePromise:a,makeCancelableCallback:n}))};t.withCanceledState=o},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/videoDataSchema.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./src/main/webapp/universal/packages/enums/RecordType.js"));var o=n(a("./src/main/webapp/universal/packages/enums/WorkflowStates.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/constants/LicensedAssetDestination.js"));var l={proxyForId:null,recordType:r.default.VIDEO,childType:null,unsaved:null,updatedOn:null,urlId:null,title:null,body:null,excerpt:{html:"",raw:false},displayIndex:0,starred:false,passthrough:false,tags:[],categories:[],workflowState:o.default.PUBLISHED,systemDataId:null,systemDataVariants:null,systemDataOrigin:null,contentType:null,fileName:null,dataSize:null,sourceUrl:null,mediaProcessingState:null,mediaFocalPoint:{x:.5,y:.5},clickthroughUrl:null,location:null,customContent:null,likeCount:0,dislikeCount:0,commentCount:0,publicCommentCount:0,commentState:2,commentDisableOn:null,pushedServices:[],shareStates:[],structuredContent:{_type:"Embed",oembed:null,overlay:true},licensedAssetPreview:null,licensedAssetId:null,isPusher:true,isWordpressXmlFile:false,imageDestination:s.default.CONTENT_ITEM_MAIN_IMAGE};var i=l;t.default=i;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withImageEditor/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=b;var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/extends.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var p=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var f=n(a("./common/temp/node_modules/lodash/noop.js"));var v=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/index.js"));var h=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));function g(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,c.default)(n),t;if(r()){var a=(0,c.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,o.default)(this,t)}}function b(a){var n=function(e){(0,u.default)(o,e);var r=g(o);function o(){var a;(0,l.default)(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a=r.call.apply(r,[this].concat(t));(0,m.default)((0,d.default)(a),"state",{isEditorOpen:false});(0,m.default)((0,d.default)(a),"openEditor",function(e){if(!e){console.error("Trying to edit an invalid content item");return}a.props.setIsBackspaceToDeleteEnabled(false);a.setState({isEditorOpen:true,contentItem:e})});(0,m.default)((0,d.default)(a),"handleCancelImageEditor",function(){a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isEditorOpen:false,contentItem:null})});(0,m.default)((0,d.default)(a),"handleSaveImageEditor",function(e){var t=a.state.contentItem;if(!t){console.error("Trying to save an invalid content item");return}a.props.replaceImage(e,t);a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isEditorOpen:false,contentItem:null})});return a}(0,i.default)(o,[{key:"render",value:function e(){var t=this.state.contentItem;return p.default.createElement(p.default.Fragment,null,p.default.createElement(a,(0,s.default)({},this.props,{openEditor:this.openEditor})),p.default.createElement(v.default,{imageSrc:t&&t.assetUrl,isOpen:this.state.isEditorOpen,onCancel:this.handleCancelImageEditor,onSave:this.handleSaveImageEditor}))}}]);return o}(p.default.Component);(0,m.default)(n,"propTypes",{replaceImage:r.default.func.isRequired,contentItem:r.default.object.isRequired,setIsBackspaceToDeleteEnabled:r.default.func});(0,m.default)(n,"defaultProps",{setIsBackspaceToDeleteEnabled:f.default});return function(a){return p.default.createElement(h.default.Consumer,null,function(e){var t=e.replaceImage;return p.default.createElement(n,(0,s.default)({},a,{replaceImage:t}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withLicensedImagePurchaseModal/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=I;var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/extends.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/objectWithoutProperties.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var m=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var p=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var f=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var v=n(a("./common/temp/node_modules/lodash/noop.js"));var h=n(a("./src/main/webapp/universal/src/apps/App/shared/components/LicenseImage/index.js"));var g=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));function b(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,s.default)(n),t;if(r()){var a=(0,s.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,o.default)(this,t)}}function I(s){var n=function(e){(0,m.default)(o,e);var r=b(o);function o(){var a;(0,d.default)(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a=r.call.apply(r,[this].concat(t));(0,p.default)((0,c.default)(a),"state",{isPurchaseLicenseOpen:false});(0,p.default)((0,c.default)(a),"openPurchaseLicenseModal",function(){a.props.setIsBackspaceToDeleteEnabled(false);a.setState({isPurchaseLicenseOpen:true})});(0,p.default)((0,c.default)(a),"uploadPurchasedLicensedImage",function(e,t){a.props.uploadFromFileUrl(t.url,t);a.setState({isPurchaseLicenseOpen:false})});return a}(0,u.default)(o,[{key:"renderPurchaseDialogIfNeeded",value:function e(){var a=this;var t=this.props.selectedIds[0];if(!t)return null;var n=this.props.items.find(function(e){return e.id===t});if(!n||!n.licensedAssetPreview)return null;return f.default.createElement(h.default,{key:"licensed-image-purchase-modal",assetPreview:n.licensedAssetPreview,previewUrl:n.assetUrl,isOpen:this.state.isPurchaseLicenseOpen,onRequestClose:function e(){a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isPurchaseLicenseOpen:false})},onPurchaseSuccess:function e(t){return a.uploadPurchasedLicensedImage(n.id,t)}})}},{key:"render",value:function e(){var t=this.props,a=t.uploadFromFileUrl,n=(0,i.default)(t,["uploadFromFileUrl"]);return f.default.createElement(f.default.Fragment,null,f.default.createElement(s,(0,l.default)({},n,{openPurchaseLicenseModal:this.openPurchaseLicenseModal})),this.renderPurchaseDialogIfNeeded())}}]);return o}(f.default.Component);(0,p.default)(n,"propTypes",{setIsBackspaceToDeleteEnabled:r.default.func});(0,p.default)(n,"defaultProps",{setIsBackspaceToDeleteEnabled:v.default});return function(a){return f.default.createElement(g.default.Consumer,null,function(e){var t=e.uploadFromFileUrl;return f.default.createElement(n,(0,l.default)({},a,{uploadFromFileUrl:t}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=u;var c=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/extends.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));var p=n(a("./common/temp/node_modules/react/index.js"));var f=n(a("./common/temp/node_modules/react-dom/index.js"));var v=n(a("./common/temp/node_modules/prop-types/index.js"));var h=n(a("./common/temp/node_modules/classnames/index.js"));var g=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var b=n(a("./common/temp/node_modules/@sqs/core-components/web/modals/AlertModal.js"));var I=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));var y=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/actions/ImagePickerViewActions.js"));var S=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/actions/GettyImageActions.js"));var C=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/constants/LicensedAssetDestination.js"));var _=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/index.js"));var j=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/styles.less"));function E(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,d.default)(n),t;if(r()){var a=(0,d.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,o.default)(this,t)}}function u(t){var u=function(e){(0,i.default)(o,e);var n=E(o);function o(){var r;(0,s.default)(this,o);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];r=n.call.apply(n,[this].concat(t));(0,m.default)((0,l.default)(r),"state",{dragOver:false,invalidFilesErrors:null,alertModalOpen:false});(0,m.default)((0,l.default)(r),"fileInputRef",p.default.createRef());(0,m.default)((0,l.default)(r),"onDiscardInvalidFilesAlert",function(){r.setState({alertModalOpen:false})});(0,m.default)((0,l.default)(r),"onDragEnter",function(e){e.preventDefault();r.setState({dragOver:true})});(0,m.default)((0,l.default)(r),"onDragOver",function(e){e.preventDefault();try{e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed=e.dataTransfer.dropEffect}catch(e){}});(0,m.default)((0,l.default)(r),"onDragLeave",function(e){r.setState({dragOver:false});r.props.disableDropZone()});(0,m.default)((0,l.default)(r),"validateAndUpload",function(e){var t=r.props.validateFiles(e),a=t.validFiles,n=t.invalidFilesErrors;n&&n.length&&r.setState({invalidFilesErrors:n,alertModalOpen:true});a.length&&r.props.uploadFiles(a)});(0,m.default)((0,l.default)(r),"onDrop",function(e){e.preventDefault();e.stopPropagation();r.setState({dragOver:false});r.props.disableDropZone();var t=Array.from(e.dataTransfer.files);r.validateAndUpload(t)});(0,m.default)((0,l.default)(r),"onFileUploaderChanges",function(e){var t=e instanceof Array?e:Array.from(e.target.files);r.validateAndUpload(t)});(0,m.default)((0,l.default)(r),"onLicensedImagePicked",function(e){y.default.finishLoadingImage();y.default.closeImagePicker();if(e.cloneItemId){r.props.reuseImage(e.cloneItemId);return}r.props.uploadFromFileUrl(e.url,e)});(0,m.default)((0,l.default)(r),"openFileInput",function(){r.fileInputRef.current&&r.fileInputRef.current.click()});(0,m.default)((0,l.default)(r),"openLicensedImagePicker",function(){S.default.search();y.default.openImagePicker()});(0,m.default)((0,l.default)(r),"renderOverlayIfPossible",function(e){var t;var a=r.props.dropzonePortalContainerRef;if(!a.current)return null;return f.default.createPortal(p.default.createElement("div",{className:(0,h.default)(j.default.dropzone,(t={},(0,m.default)(t,j.default.onDragOver,r.state.dragOver),(0,m.default)(t,j.default.disablePointerEvents,!r.props.dropZoneEnabled),(0,m.default)(t,j.default.hasNoItems,!e),t)),onDragEnter:r.onDragEnter,onDragOver:r.onDragOver,onDragLeave:r.onDragLeave,onDrop:r.onDrop},r.state.dragOver?p.default.createElement("p",null,(0,g.t)("Drop Images to Upload")):e?null:p.default.createElement("p",null,(0,g.t)("Drag your image here or click + to upload")),p.default.createElement("input",{ref:r.fileInputRef,className:j.default.hiddenInput,accept:"image/png,image/gif,image/jpeg",type:"file",multiple:true,onChange:r.onFileUploaderChanges})),a.current)});return r}(0,r.default)(o,[{key:"render",value:function e(){return p.default.createElement(p.default.Fragment,null,p.default.createElement(b.default,{isOpen:this.state.alertModalOpen,title:(0,g.t)("Invalid files"),message:this.state.invalidFilesErrors,onDismiss:this.onDiscardInvalidFilesAlert,onRequestClose:this.onDiscardInvalidFilesAlert}),p.default.createElement(_.default,{baseZIndex:300001,onUnlicensedPreview:this.onLicensedImagePicked,onLicensedPreview:this.onLicensedImagePicked,imageDestination:C.default.GALLERY_COLLECTION}),p.default.createElement(t,(0,c.default)({},this.props,{uploader:{openLicensedImagePicker:this.openLicensedImagePicker,openFileInput:this.openFileInput,onFileUploaderChanges:this.onFileUploaderChanges,renderOverlayIfPossible:this.renderOverlayIfPossible}})))}}]);return o}(p.default.Component);(0,m.default)(u,"propTypes",{uploadFiles:v.default.func.isRequired,validateFiles:v.default.func.isRequired});return function(d){return p.default.createElement(I.default.Consumer,null,function(e){var t=e.uploadFiles,a=e.validateFiles,n=e.uploadFromFileUrl,r=e.reuseImage,o=e.uploadVideo,s=e.cancelUpload,l=e.cancelJob,i=e.dropzonePortalContainerRef;return p.default.createElement(u,(0,c.default)({},d,{uploadFiles:t,validateFiles:a,uploadFromFileUrl:n,reuseImage:r,uploadVideo:o,cancelUpload:s,cancelJob:l,dropzonePortalContainerRef:i}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/styles.less":function(e,t,a){e.exports={dropzone:"styles-dropzone-3FnFe",hasNoItems:"styles-hasNoItems-1B9N9",disablePointerEvents:"styles-disablePointerEvents-1bN8B",onDragOver:"styles-onDragOver-BIi3x",hiddenInput:"styles-hiddenInput-5HZ0r"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionSettings/utils/StoreUtils.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.getSectionActions=t.getSectionStore=void 0;var r=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/PageSectionsStore.js"));var o=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/FooterSectionsStore.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/PageSectionsActions.js"));var l=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/FooterSectionsActions.js"));var i=function e(){var t=r.default.getState();var a=o.default.getState();var n=a.isEditing?a:t;return n};t.getSectionStore=i;var d=function e(){var t=o.default.getState();var a=t.isEditing?l.default:s.default;return a};t.getSectionActions=d},"./src/main/webapp/universal/src/apps/App/shared/stores/GalleryStore.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./src/main/webapp/universal/src/shared/dispatchers/alt/index.ts"));var i=n(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var d=n(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var u=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var c=n(a("./src/main/webapp/universal/src/shared/stores/JobStore.js"));var m=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js"));var p=function e(t,a){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];t.splice.apply(t,[a,0].concat(r));return t};var f=function e(t,a){t.splice(t.indexOf(a),1);return t};var v=function e(t,a,n){t.splice(t.indexOf(a),1,n);return t};var h=function(){function e(){(0,r.default)(this,e);this.state={loading:false,error:null,collectionId:null,items:[],finishedJobs:[]};this.bindActions(m.default);this.bindListeners({onUploadFile:[i.default.UPLOAD_FILE,i.default.UPLOAD_FROM_FILE_URL],onUploadSuccess:i.default.UPLOAD_SUCCESS,onJobComplete:d.default.COMPLETE,onCancelUpload:i.default.CANCEL_UPLOAD,onCreateNewItem:u.default.createForCollection,onInsert:u.default.insert,onItemRemove:u.default.delete,onItemsRemove:u.default.deleteMany,onItemReorder:u.default.reorderItems})}(0,s.default)(e,[{key:"onLoadStart",value:function e(){this.setState({loading:true,error:null})}},{key:"onLoadSuccess",value:function e(t){var a=t.collectionId,n=void 0===a?null:a,r=t.contentItems,o=void 0===r?[]:r,s=t.uploads,l=void 0===s?[]:s;var i=o.sort(function(e,t){return e.displayIndex<t.displayIndex?-1:1}).map(function(e){return{key:"item-".concat(e.id),contentItemId:e.id}});l.forEach(function(e){var t=e.token,a=e.data;p(i,a.index,{key:"new-".concat(t.getId()),uploadToken:t})});this.setState({loading:false,error:null,collectionId:n,items:i})}},{key:"onLoadFailure",value:function e(t){var a=t.collectionId,n=void 0===a?null:a,r=t.error;this.setState({loading:false,error:r,collectionId:n})}},{key:"onUploadFile",value:function e(t){var a=t.token,n=t.data;var r=n.collectionId,o=n.replaceItemId,s=n.index;if(r===this.state.collectionId){var l=[].concat(this.state.items);if(o){var i=l.find(function(e){return e.contentItemId===o});i?v(l,i,{key:i.key,uploadToken:a}):p(l,s,{key:"new-".concat(a.getId()),uploadToken:a})}else p(l,s,{key:"new-".concat(a.getId()),uploadToken:a});this.setState({items:l})}}},{key:"onUploadSuccess",value:function e(t){var a=t.token,n=t.data;var r=this.state.items.find(function(e){return e.uploadToken===a});var o=n.job;if(r){var s=v([].concat(this.state.items),r,{key:r.key,contentItemId:n.contentItem.id});o&&(s=s.map(function(e){if(e.contentItemId===n.contentItem.id)return{key:r.key,contentItemId:n.contentItem.id,jobId:o.id};return e}));this.waitFor(c.default);this.setState({items:s})}}},{key:"onJobComplete",value:function e(t){var a=(0,o.default)(this.state.items);var n=(0,o.default)(this.state.finishedJobs);n=[].concat(n,t);a=a.map(function(e){if(e.jobId&&t.includes(e.jobId))return{key:e.key,contentItemId:e.contentItemId};return e});this.setState({items:a,finishedJobs:n})}},{key:"onCancelUpload",value:function e(t){var a=this.state.items.find(function(e){return e.uploadToken===t});if(a){var n=f([].concat(this.state.items),a);this.setState({items:n})}}},{key:"onCancelJob",value:function e(t){var a=c.default.getJobById(t).data.contentItemId;var n=this.state.items.find(function(e){return e.contentItemId===a});if(n){var r=f([].concat(this.state.items),n);this.setState({items:r})}}},{key:"onCreateNewItem",value:function e(t){if(!t.id)return;var a=p([].concat(this.state.items),t.displayIndex,{key:"item-".concat(t.id),contentItemId:t.id});this.setState({items:a})}},{key:"onInsert",value:function e(t){if(t.collectionId===this.state.collectionId){var a=this.state.items.find(function(e){return e.contentItemId===t.id});if(a)return;var n=p([].concat(this.state.items),t.displayIndex,{key:"item-".concat(t.id),contentItemId:t.id});this.setState({items:n})}}},{key:"onItemRemove",value:function e(t){var a=this.state.items.find(function(e){return e.contentItemId===t});if(a){var n=f([].concat(this.state.items),a);this.setState({items:n})}}},{key:"onItemsRemove",value:function e(t){var a=this.state.items.filter(function(e){return-1===t.indexOf(e.contentItemId)});a.length!==this.state.items.length&&this.setState({items:a})}},{key:"onItemReorder",value:function e(t){var a=t.collectionId,n=t.reorderedItems;if(a===this.state.collectionId){var r=[].concat(this.state.items);r.splice.apply(r,[n[0].displayIndex,n.length].concat((0,o.default)(n.map(function(e){var t=e.id;return r.find(function(e){return e.contentItemId===t})}))));this.setState({items:r})}}}]);return e}();var g=l.default.createStore(h,"GalleryStore");t.default=g;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/utils/MediaUploadService.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.isMediaUploadServiceEnabled=f;t.default=void 0;var r=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var s=n(a("./src/main/webapp/universal/packages/enums/Flag.js"));var l=n(a("./src/main/webapp/universal/src/shared/utils/AltActionListener.js"));var i=a("./src/main/webapp/universal/src/shared/utils/coreCmsFlags.ts");var d=n(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var u=n(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var c=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var m=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/WebsiteStore/index.js"));var p=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/BetaFeaturesUtils.js"));function f(){return(0,i.isCoreCmsVariant)(i.ASSET_UPLOAD_TO_MEDIA_UPLOAD_SERVICE)||p.default.isFeatureEnabled(s.default.ASSET_UPLOAD_TO_MEDIA_UPLOAD_SERVICE)}var v=function(){function e(){(0,r.default)(this,e);l.default.addActionListener(u.default.MEDIA_UPLOAD_SERVICE_JOB_COMPLETE,function(e){return c.default.createAssetReference(e)})}(0,o.default)(e,[{key:"uploadFile",value:function e(t,a){var n=m.default.getState().id;return d.default.uploadFileToMediaUploadService(t,a,n)}},{key:"uploadFiles",value:function e(t,a){var n=m.default.getState().id;return d.default.uploadFilesToMediaUploadService(t,a,n)}}]);return e}();var h=new v;t.default=h},"./src/main/webapp/universal/src/shared/components/DragSelection.jsx":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/interopRequireDefault.js");var m=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/extends.js"));var p=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/objectWithoutProperties.js"));var f=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/slicedToArray.js"));var o=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/inherits.js"));var d=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var v=n(a("./common/temp/node_modules/@rush-temp/universal-frontend/node_modules/@babel/runtime/helpers/defineProperty.js"));function c(n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var e=(0,u.default)(n),t;if(r()){var a=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,d.default)(this,t)}}var h=a("./common/temp/node_modules/classnames/index.js");var r=a("./common/temp/node_modules/prop-types/index.js");var g=a("./common/temp/node_modules/react/index.js");var b=a("./common/temp/node_modules/@sqs/dnd/cjs/index.js"),I=b.DragTrigger;var y=a("./common/temp/node_modules/@sqs/utils/NodeCoordinatesTracker/index.js");var S=a("./common/temp/node_modules/@sqs/utils/number/clamp.js");var C=a("./common/temp/node_modules/@sqs/utils/events/parentScroll.js"),_=C.addScrollListenerToParents,j=C.removeScrollListenerFromParents;var E=a("./common/temp/node_modules/lodash/difference.js");var P=a("./common/temp/node_modules/lodash/throttle.js");var w=a("./src/main/webapp/universal/src/shared/components/DragSelection.less");var D=function e(t,a){return t.right>=a.left&&t.left<=a.right&&t.bottom>=a.top&&t.top<=a.bottom};var k=function(e){(0,i.default)(r,e);var n=c(r);function r(){var p;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];p=n.call.apply(n,[this].concat(t));(0,v.default)((0,l.default)(p),"state",{isDragging:false,itemsMap:null,selectionCoords:null,selectedItemIndexes:[],mouseXY:null,anchorXY:null});(0,v.default)((0,l.default)(p),"onDrag",P(function(e){var t=e.mouseX,a=e.mouseY,n=e.maxX,r=e.maxY,o=e.minX,s=e.minY;var l=p.state,i=l.itemsMap,d=l.anchorXY;if(!i)return;var u=[S(t,o,n),S(a,s,r)];var c=p.calculateSelectionCoords(u,d);var m=p.getContainedOrIntersectedItems(c);p.setState({mouseXY:u,selectionCoords:c,selectedItemIndexes:m})},30));return p}(0,s.default)(r,[{key:"componentDidMount",value:function e(){this.coordsTracker=new y(this.refs.container)}},{key:"shouldComponentUpdate",value:function e(t,a){return this.state.isDragging!==a.isDragging||this.state.selectionCoords!==a.selectionCoords}},{key:"componentDidUpdate",value:function e(t,a){var n=this.state.isDragging;n&&this.fireSelectionChange(a.selectedItemIndexes)}},{key:"componentWillUnmount",value:function e(){var t=this.state,a=t.itemsMap,n=t.isDragging;a&&a.forEach(function(e){var t=e.coordsTracker;return t.destroy()});this.coordsTracker.destroy();this.coordsTracker=null;n&&j(this.refs.container,this.udpateCoordsOnScroll)}},{key:"fireSelectionChange",value:function e(t){var a=this.state.selectedItemIndexes;var n=this.props.items;var r=E(a,t);var o=E(t,a);(r.length>0||o.length>0)&&this.props.onSelectionChange({added:r.map(function(e){return n[e]}),removed:o.map(function(e){return n[e]})})}},{key:"udpateCoordsOnScroll",value:function e(t,a){var n=this.state,r=n.mouseXY,o=n.anchorXY;var s=[o[0]+t,o[1]+a];this.setState({anchorXY:s,selectionCoords:this.calculateSelectionCoords(r,s)})}},{key:"onDragStart",value:function e(t){var a=t.startX,n=t.startY;var r=this.props,o=r.items,s=r.itemNodesGetter,e=r.onDragStart;this.coordsTracker.resetCoords();_(this.refs.container,this.udpateCoordsOnScroll);this.setState({isDragging:true,selectionCoords:null,itemsMap:s(o).map(function(e,t){return{index:t,coordsTracker:new y(e)}}),anchorXY:[a,n],mouseXY:[a,n]});e&&e.apply(void 0,arguments)}},{key:"calculateSelectionCoords",value:function e(t,a){var n=(0,f.default)(t,2),r=n[0],o=n[1];var s=(0,f.default)(a,2),l=s[0],i=s[1];var d;var u;var c;var m;if(l<=r){c=l;m=r}else{c=r;m=l}if(i<=o){d=i;u=o}else{d=o;u=i}return{top:d,left:c,bottom:u,right:m}}},{key:"getContainedOrIntersectedItems",value:function e(n){var t=this.state.itemsMap;if(t)return t.filter(function(e){var t=e.index,a=e.coordsTracker;return D(a.getCoords(),n)}).map(function(e){var t=e.index;return t});return[]}},{key:"onDragEnd",value:function e(){var t=this.state,a=t.itemsMap,n=t.selectedItemIndexes;var r=this.props,e=r.onDragEnd,o=r.items;a&&a.forEach(function(e){var t=e.coordsTracker;return t.destroy()});j(this.refs.container,this.udpateCoordsOnScroll);this.setState({isDragging:false,itemsMap:null,selectedItemIndexes:[],mouseXY:null,anchorXY:null});e&&e.apply(void 0,[{selectedItems:n.map(function(e){return o[e]})}].concat(Array.prototype.slice.call(arguments)))}},{key:"getAbsolutePosition",value:function e(t){var a=this.coordsTracker.getCoords();return{top:t.top-a.top,left:t.left-a.left,bottom:a.bottom-t.bottom,right:a.right-t.right}}},{key:"render",value:function e(){var t=this;var a=this.state,n=a.isDragging,r=a.selectionCoords;var o=this.props,s=o.className,l=o.children,i=(0,p.default)(o,["className","children"]);delete i.items;delete i.itemNodesGetter;delete i.onSelectionChange;var d=h(w.container,s,(0,v.default)({},w.dragging,n));var u=h(w.selection,n&&w.visible);var c=r?this.getAbsolutePosition(r):null;return g.createElement(I,(0,m.default)({key:"trigger",constraint:function e(){return t.refs.container}},i,{onDragStart:this.onDragStart.bind(this),onDrag:this.onDrag.bind(this),onDragEnd:this.onDragEnd.bind(this),autoScroll:{vertical:true}}),g.createElement("div",{ref:"container",key:"container",className:d},l,g.createElement("div",{key:"selection",className:u,style:c})))}}]);return r}(g.Component);(0,v.default)(k,"propTypes",{items:r.array.isRequired,itemNodesGetter:r.func.isRequired,onSelectionChange:r.func,onDragStart:r.func,onDragEnd:r.func});(0,v.default)(k,"defaultProps",{itemNodesGetter:function e(){return[]},items:[],onSelectionChange:function e(){}});(0,v.default)(k,"itemClassName",w.item);e.exports=k},"./src/main/webapp/universal/src/shared/components/DragSelection.less":function(e,t,a){e.exports={container:"DragSelection-container-CBfko",dragging:"DragSelection-dragging-2sGNZ",selection:"DragSelection-selection-2js8t",visible:"DragSelection-visible-g3fgA",item:"DragSelection-item-2EEHz"}}}]);
//# sourceMappingURL=https://sourcemaps.squarespace.net/universal/scripts-compressed/async-page-section-gallery-content-c0e396390222eaed5d8e6-min.en-US.js.map